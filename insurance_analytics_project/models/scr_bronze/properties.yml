version: 2

models:
  - name: bronze_staging_table
    config:
      materialized: view
      schema: scr_bronze

    columns:
      - name: id
        tests:
          - unique:
              config:
                severity: warn
          - not_null:
              config:
                severity: warn

      - name: gender
        tests:
          - accepted_values:
              values: ['Male', 'Female']
              config:
                severity: warn  

      - name: policy_start_date
        tests:
          - not_null:
              config:
                severity: warn

      - name: age
        tests:
          - accepted_range:
              min_value: 15
              max_value: 100

      - name: vehicle_age
        tests:
          - accepted_range:
              min_value: 0
              max_value: 25

      - name: credit_score
        tests:
          - accepted_range:
              min_value: 300
              max_value: 900

      - name: insurance_duration
        tests:
          - accepted_range:
              min_value: 0
              max_value: 70

      - name: annual_income
        tests:
          - accepted_range:
              min_value: 0
              max_value: 250000